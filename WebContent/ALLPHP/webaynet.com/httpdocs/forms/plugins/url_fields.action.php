<?php
    /**
     * Project: Form Processor Pro
     * File: url_fields.action.php
     * 
     * @version 5.0
     * @copyright MitriDAT <info@mitridat.com>
     * @author Rosty Kerei <rosty.kerei@gmail.com>
     * @link http://www.email-form.com/
     * @package Actions
     * @subpackage Validators
     */

    /**
     * European VAT-numbers validator
     * 
     * @package FPP5
     */
    class url_fields_action extends Validator {
        function execute(){
        	global $lang;
$regex  =   '#(?:http://(?:(?:(?:(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?)\.';
$regex .=   ')*(?:[a-zA-Z](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?:\d+)(?:\.(?:\d+)';
$regex .=   '){3}))(?::(?:\d+))?)(?:/(?:(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F';
$regex .=   '\d]{2}))|[;:@&=])*)(?:/(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{';
$regex .=   '2}))|[;:@&=])*))*)(?:\?(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{';
$regex .=   '2}))|[;:@&=])*))?)?)|(?:ftp://(?:(?:(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?';
$regex .=   ':%[a-fA-F\d]{2}))|[;?&=])*)(?::(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-';
$regex .=   'fA-F\d]{2}))|[;?&=])*))?@)?(?:(?:(?:(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-';
$regex .=   ')*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?';
$regex .=   ':\d+)(?:\.(?:\d+)){3}))(?::(?:\d+))?))(?:/(?:(?:(?:(?:[a-zA-Z\d$\-_.+!';
$regex .=   '*\'(),]|(?:%[a-fA-F\d]{2}))|[?:@&=])*)(?:/(?:(?:(?:[a-zA-Z\d$\-_.+!*\'()';
$regex .=   ',]|(?:%[a-fA-F\d]{2}))|[?:@&=])*))*)(?:;type=[AIDaid])?)?)|(?:news:(?:';
$regex .=   '(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[;/?:&=])+@(?:(?:(';
$regex .=   '?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:(?:[';
$regex .=   'a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?:\d+)(?:\.(?:\d+)){3})))|(?:[a-zA-Z](';
$regex .=   '?:[a-zA-Z\d]|[_.+-])*)|\*))|(?:nntp://(?:(?:(?:(?:(?:[a-zA-Z\d](?:(?:[';
$regex .=   'a-zA-Z\d]|-)*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d';
$regex .=   '])?))|(?:(?:\d+)(?:\.(?:\d+)){3}))(?::(?:\d+))?)/(?:[a-zA-Z](?:[a-zA-Z';
$regex .=   '\d]|[_.+-])*)(?:/(?:\d+))?)|(?:telnet://(?:(?:(?:(?:(?:[a-zA-Z\d$\-_.+';
$regex .=   '!*\'(),]|(?:%[a-fA-F\d]{2}))|[;?&=])*)(?::(?:(?:(?:[a-zA-Z\d$\-_.+!*\'()';
$regex .=   ',]|(?:%[a-fA-F\d]{2}))|[;?&=])*))?@)?(?:(?:(?:(?:(?:[a-zA-Z\d](?:(?:[a';
$regex .=   '-zA-Z\d]|-)*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d]';
$regex .=   ')?))|(?:(?:\d+)(?:\.(?:\d+)){3}))(?::(?:\d+))?))/?)|(?:gopher://(?:(?:';
$regex .=   '(?:(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:';
$regex .=   '(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?:\d+)(?:\.(?:\d+)){3}))(?::(?:\d+';
$regex .=   '))?)(?:/(?:[a-zA-Z\d$\-_.+!*\'(),;/?:@&=]|(?:%[a-fA-F\d]{2}))(?:(?:(?:[';
$regex .=   'a-zA-Z\d$\-_.+!*\'(),;/?:@&=]|(?:%[a-fA-F\d]{2}))*)(?:%09(?:(?:(?:[a-zA';
$regex .=   '-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[;:@&=])*)(?:%09(?:(?:[a-zA-Z\d$';
$regex .=   '\-_.+!*\'(),;/?:@&=]|(?:%[a-fA-F\d]{2}))*))?)?)?)?)|(?:wais://(?:(?:(?:';
$regex .=   '(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:(?:';
$regex .=   '[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?:\d+)(?:\.(?:\d+)){3}))(?::(?:\d+))?';
$regex .=   ')/(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))*)(?:(?:/(?:(?:[a-zA';
$regex .=   '-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))*)/(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(';
$regex .=   '?:%[a-fA-F\d]{2}))*))|\?(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]';
$regex .=   '{2}))|[;:@&=])*))?)|(?:mailto:(?:(?:[a-zA-Z\d$\-_.+!*\'(),;/?:@&=]|(?:%';
$regex .=   '[a-fA-F\d]{2}))+))|(?:file://(?:(?:(?:(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]';
$regex .=   '|-)*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:';
$regex .=   '(?:\d+)(?:\.(?:\d+)){3}))|localhost)?/(?:(?:(?:(?:[a-zA-Z\d$\-_.+!*\'()';
$regex .=   ',]|(?:%[a-fA-F\d]{2}))|[?:@&=])*)(?:/(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(';
$regex .=   '?:%[a-fA-F\d]{2}))|[?:@&=])*))*))|(?:prospero://(?:(?:(?:(?:(?:[a-zA-Z';
$regex .=   '\d](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:(?:[a-zA-Z\d]|-)';
$regex .=   '*[a-zA-Z\d])?))|(?:(?:\d+)(?:\.(?:\d+)){3}))(?::(?:\d+))?)/(?:(?:(?:(?';
$regex .=   ':[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[?:@&=])*)(?:/(?:(?:(?:[a-';
$regex .=   'zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[?:@&=])*))*)(?:(?:;(?:(?:(?:[';
$regex .=   'a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[?:@&])*)=(?:(?:(?:[a-zA-Z\d';
$regex .=   '$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[?:@&])*)))*)|(?:ldap://(?:(?:(?:(?:';
$regex .=   '(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:(?:';
$regex .=   '[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?:\d+)(?:\.(?:\d+)){3}))(?::(?:\d+))?';
$regex .=   '))?/(?:(?:(?:(?:(?:(?:(?:[a-zA-Z\d]|%(?:3\d|[46][a-fA-F\d]|[57][Aa\d])';
$regex .=   ')|(?:%20))+|(?:OID|oid)\.(?:(?:\d+)(?:\.(?:\d+))*))(?:(?:%0[Aa])?(?:%2';
$regex .=   '0)*)=(?:(?:%0[Aa])?(?:%20)*))?(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F';
$regex .=   '\d]{2}))*))(?:(?:(?:%0[Aa])?(?:%20)*)\+(?:(?:%0[Aa])?(?:%20)*)(?:(?:(?';
$regex .=   ':(?:(?:[a-zA-Z\d]|%(?:3\d|[46][a-fA-F\d]|[57][Aa\d]))|(?:%20))+|(?:OID';
$regex .=   '|oid)\.(?:(?:\d+)(?:\.(?:\d+))*))(?:(?:%0[Aa])?(?:%20)*)=(?:(?:%0[Aa])';
$regex .=   '?(?:%20)*))?(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))*)))*)(?:(';
$regex .=   '?:(?:(?:%0[Aa])?(?:%20)*)(?:[;,])(?:(?:%0[Aa])?(?:%20)*))(?:(?:(?:(?:(';
$regex .=   '?:(?:[a-zA-Z\d]|%(?:3\d|[46][a-fA-F\d]|[57][Aa\d]))|(?:%20))+|(?:OID|o';
$regex .=   'id)\.(?:(?:\d+)(?:\.(?:\d+))*))(?:(?:%0[Aa])?(?:%20)*)=(?:(?:%0[Aa])?(';
$regex .=   '?:%20)*))?(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))*))(?:(?:(?:';
$regex .=   '%0[Aa])?(?:%20)*)\+(?:(?:%0[Aa])?(?:%20)*)(?:(?:(?:(?:(?:[a-zA-Z\d]|%(';
$regex .=   '?:3\d|[46][a-fA-F\d]|[57][Aa\d]))|(?:%20))+|(?:OID|oid)\.(?:(?:\d+)(?:';
$regex .=   '\.(?:\d+))*))(?:(?:%0[Aa])?(?:%20)*)=(?:(?:%0[Aa])?(?:%20)*))?(?:(?:[a';
$regex .=   '-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))*)))*))*(?:(?:(?:%0[Aa])?(?:%2';
$regex .=   '0)*)(?:[;,])(?:(?:%0[Aa])?(?:%20)*))?)(?:\?(?:(?:(?:(?:[a-zA-Z\d$\-_.+';
$regex .=   '!*\'(),]|(?:%[a-fA-F\d]{2}))+)(?:,(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-f';
$regex .=   'A-F\d]{2}))+))*)?)(?:\?(?:base|one|sub)(?:\?(?:((?:[a-zA-Z\d$\-_.+!*\'(';
$regex .=   '),;/?:@&=]|(?:%[a-fA-F\d]{2}))+)))?)?)?)|(?:(?:z39\.50[rs])://(?:(?:(?';
$regex .=   ':(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?)\.)*(?:[a-zA-Z](?:(?';
$regex .=   ':[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?:\d+)(?:\.(?:\d+)){3}))(?::(?:\d+))';
$regex .=   '?)(?:/(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))+)(?:\+(?:(?:';
$regex .=   '[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))+))*(?:\?(?:(?:[a-zA-Z\d$\-_';
$regex .=   '.+!*\'(),]|(?:%[a-fA-F\d]{2}))+))?)?(?:;esn=(?:(?:[a-zA-Z\d$\-_.+!*\'(),';
$regex .=   ']|(?:%[a-fA-F\d]{2}))+))?(?:;rs=(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA';
$regex .=   '-F\d]{2}))+)(?:\+(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))+))*)';
$regex .=   '?))|(?:cid:(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[;?:@&=';
$regex .=   '])*))|(?:mid:(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[;?:@';
$regex .=   '&=])*)(?:/(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[;?:@&=]';
$regex .=   ')*))?)|(?:vemmi://(?:(?:(?:(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-)*[a-zA-Z';
$regex .=   '\d])?)\.)*(?:[a-zA-Z](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?:\d+)(?:\\';
$regex .=   '.(?:\d+)){3}))(?::(?:\d+))?)(?:/(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a';
$regex .=   '-fA-F\d]{2}))|[/?:@&=])*)(?:(?:;(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a';
$regex .=   '-fA-F\d]{2}))|[/?:@&])*)=(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d';
$regex .=   ']{2}))|[/?:@&])*))*))?)|(?:imap://(?:(?:(?:(?:(?:(?:(?:[a-zA-Z\d$\-_.+';
$regex .=   '!*\'(),]|(?:%[a-fA-F\d]{2}))|[&=~])+)(?:(?:;[Aa][Uu][Tt][Hh]=(?:\*|(?:(';
$regex .=   '?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[&=~])+))))?)|(?:(?:;[';
$regex .=   'Aa][Uu][Tt][Hh]=(?:\*|(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2';
$regex .=   '}))|[&=~])+)))(?:(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[';
$regex .=   '&=~])+))?))@)?(?:(?:(?:(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])';
$regex .=   '?)\.)*(?:[a-zA-Z](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?:\d+)(?:\.(?:';
$regex .=   '\d+)){3}))(?::(?:\d+))?))/(?:(?:(?:(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:';
$regex .=   '%[a-fA-F\d]{2}))|[&=~:@/])+)?;[Tt][Yy][Pp][Ee]=(?:[Ll](?:[Ii][Ss][Tt]|';
$regex .=   '[Ss][Uu][Bb])))|(?:(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))';
$regex .=   '|[&=~:@/])+)(?:\?(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[';
$regex .=   '&=~:@/])+))?(?:(?:;[Uu][Ii][Dd][Vv][Aa][Ll][Ii][Dd][Ii][Tt][Yy]=(?:[1-';
$regex .=   '9]\d*)))?)|(?:(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[&=~';
$regex .=   ':@/])+)(?:(?:;[Uu][Ii][Dd][Vv][Aa][Ll][Ii][Dd][Ii][Tt][Yy]=(?:[1-9]\d*';
$regex .=   ')))?(?:/;[Uu][Ii][Dd]=(?:[1-9]\d*))(?:(?:/;[Ss][Ee][Cc][Tt][Ii][Oo][Nn';
$regex .=   ']=(?:(?:(?:[a-zA-Z\d$\-_.+!*\'(),]|(?:%[a-fA-F\d]{2}))|[&=~:@/])+)))?))';
$regex .=   ')?)|(?:nfs:(?:(?://(?:(?:(?:(?:(?:[a-zA-Z\d](?:(?:[a-zA-Z\d]|-)*[a-zA-';
$regex .=   'Z\d])?)\.)*(?:[a-zA-Z](?:(?:[a-zA-Z\d]|-)*[a-zA-Z\d])?))|(?:(?:\d+)(?:';
$regex .=   '\.(?:\d+)){3}))(?::(?:\d+))?)(?:(?:/(?:(?:(?:(?:(?:[a-zA-Z\d\$\-_.!~*\'';
$regex .=   '(),])|(?:%[a-fA-F\d]{2})|[:@&=+])*)(?:/(?:(?:(?:[a-zA-Z\d\$\-_.!~*\'(),';
$regex .=   '])|(?:%[a-fA-F\d]{2})|[:@&=+])*))*)?)))?)|(?:/(?:(?:(?:(?:(?:[a-zA-Z\d';
$regex .=   '\$\-_.!~*\'(),])|(?:%[a-fA-F\d]{2})|[:@&=+])*)(?:/(?:(?:(?:[a-zA-Z\d\$\\';
$regex .=   '-_.!~*\'(),])|(?:%[a-fA-F\d]{2})|[:@&=+])*))*)?))|(?:(?:(?:(?:(?:[a-zA-';
$regex .=   'Z\d\$\-_.!~*\'(),])|(?:%[a-fA-F\d]{2})|[:@&=+])*)(?:/(?:(?:(?:[a-zA-Z\d';
$regex .=   '\$\-_.!~*\'(),])|(?:%[a-fA-F\d]{2})|[:@&=+])*))*)?)))#';
            $fields = $this->getUnmatchFields($regex);
            
            foreach ($fields as $field){
                $this->fieldError($field['name'], $lang->getValue('form_err_url', $field['label']));
            }
        }

    }
?>